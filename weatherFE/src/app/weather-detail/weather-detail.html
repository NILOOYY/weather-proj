<div class="weather-detail-page">
  <div class="container py-4">
    <!-- Back Button -->
    <a routerLink="/weather" class="btn btn-outline-primary mb-4">
      <i class="bi bi-arrow-left"></i> Back to Weather List
    </a>

    <!-- Loading State -->
    <div *ngIf="!weather" class="text-center py-5">
      <div class="spinner-border text-primary" style="width: 3rem; height: 3rem;"></div>
      <p class="mt-3 text-muted">Loading weather details...</p>
    </div>

    <!-- Weather Details -->
    <div *ngIf="weather">
      <!-- Header Card -->
      <div class="detail-header card border-0 shadow-lg mb-4">
        <div class="card-body p-4">
          <div class="row align-items-center">
            <div class="col-md-8">
              <h1 class="display-5 fw-bold mb-2">
                <i class="bi bi-geo-alt-fill text-primary"></i> {{ weather.city }}
              </h1>
              <p class="text-muted mb-0">
                <i class="bi bi-building"></i> {{ weather.station_name }}
                <span *ngIf="weather.region"> ‚Ä¢ {{ weather.region }}</span>
                <span *ngIf="weather.country"> ‚Ä¢ {{ weather.country }}</span>
              </p>
            </div>
            <div class="col-md-4 text-md-end">
              <div class="temp-badge">
                <div class="display-2 fw-bold">{{ weather.avg_temp_c }}¬∞C</div>
                <div class="text-muted">{{ weather.overall_condition }}</div>
              </div>
            </div>
          </div>
        </div>
      </div>

      <!-- Stats Grid -->
      <div class="row g-4 mb-4">
        <div class="col-md-3 col-sm-6">
          <div class="stat-box card border-0 shadow-sm h-100">
            <div class="card-body text-center">
              <div class="stat-icon mb-2">üå°Ô∏è</div>
              <div class="stat-value">{{ weather.avg_temp_c }}¬∞C</div>
              <div class="stat-label">Temperature</div>
            </div>
          </div>
        </div>
        <div class="col-md-3 col-sm-6">
          <div class="stat-box card border-0 shadow-sm h-100">
            <div class="card-body text-center">
              <div class="stat-icon mb-2">üí®</div>
              <div class="stat-value">{{ weather.max_wind_kmh }}</div>
              <div class="stat-label">Wind (km/h)</div>
            </div>
          </div>
        </div>
        <div class="col-md-3 col-sm-6">
          <div class="stat-box card border-0 shadow-sm h-100">
            <div class="card-body text-center">
              <div class="stat-icon mb-2">üå´Ô∏è</div>
              <div class="stat-value">{{ weather.air_quality_index }}</div>
              <div class="stat-label">Air Quality</div>
            </div>
          </div>
        </div>
        <div class="col-md-3 col-sm-6">
          <div class="stat-box card border-0 shadow-sm h-100">
            <div class="card-body text-center">
              <div class="stat-icon mb-2">üëÅÔ∏è</div>
              <div class="stat-value">{{ weather.views || 0 }}</div>
              <div class="stat-label">Views</div>
            </div>
          </div>
        </div>
      </div>

      <!-- Alerts -->
      <div *ngIf="weather.alerts && weather.alerts.length > 0" class="alert-section mb-4">
        <div class="card border-0 shadow-sm border-start border-danger border-4">
          <div class="card-body">
            <h5 class="mb-3"><i class="bi bi-exclamation-triangle-fill text-danger"></i> Active Alerts</h5>
            <div class="d-flex flex-wrap gap-2">
              <span class="badge bg-danger" *ngFor="let alert of weather.alerts">
                ‚ö†Ô∏è {{ alert }}
              </span>
            </div>
          </div>
        </div>
      </div>

      <!-- Map Section -->
      <div *ngIf="mapCenter" class="map-section card border-0 shadow-lg mb-4">
        <div class="card-header bg-primary text-white">
          <h5 class="mb-0"><i class="bi bi-map"></i> Station Location</h5>
        </div>
        <div class="card-body p-0">
          <google-map
            height="400px"
            width="100%"
            [center]="mapCenter"
            [zoom]="mapZoom"
            [options]="{ mapTypeId: 'roadmap' }">
            <map-marker
              *ngIf="markerPosition"
              [position]="markerPosition"
              [title]="weather?.city">
            </map-marker>
          </google-map>
        </div>
      </div>

      <!-- Comments Section -->
      <div class="comments-section card border-0 shadow-lg">
        <div class="card-header bg-light">
          <h5 class="mb-0"><i class="bi bi-chat-dots"></i> Comments ({{ comments.length }})</h5>
        </div>
        <div class="card-body">
          <!-- Empty State -->
          <div *ngIf="comments.length === 0" class="text-center py-4 text-muted">
            <i class="bi bi-chat-square-text" style="font-size: 3rem; opacity: 0.3;"></i>
            <p class="mt-2">No comments yet. Be the first to comment!</p>
          </div>

          <!-- Comments List -->
          <div class="comments-list mb-4" *ngIf="comments.length > 0">
            <div class="comment-item card mb-3" *ngFor="let c of comments">
              <div class="card-body">
                <div class="d-flex justify-content-between align-items-start">
                  <div>
                    <h6 class="mb-1">
                      <i class="bi bi-person-circle text-primary"></i> {{ c.username }}
                    </h6>
                    <p class="mb-2">{{ c.comment }}</p>
                    <small class="text-muted">
                      <i class="bi bi-clock"></i> {{ c.created_at | date:'short' }}
                    </small>
                  </div>
                  <div *ngIf="c.rating" class="rating-badge">
                    <span class="badge bg-warning">‚≠ê {{ c.rating }}</span>
                  </div>
                </div>
              </div>
            </div>
          </div>

          <!-- Add Comment Form -->
          <div class="add-comment-form">
            <h6 class="mb-3">Add Your Comment</h6>
            <div class="mb-3">
              <input 
                class="form-control" 
                placeholder="Your name"
                [(ngModel)]="newUsername"
              />
            </div>
            <div class="mb-3">
              <textarea 
                class="form-control" 
                rows="3"
                placeholder="Write your comment..."
                [(ngModel)]="newComment"
              ></textarea>
            </div>
            <div class="mb-3">
              <label class="form-label">Rating (optional)</label>
              <select class="form-select" [(ngModel)]="newRating">
                <option [value]="0">No rating</option>
                <option [value]="1">‚≠ê 1 Star</option>
                <option [value]="2">‚≠ê‚≠ê 2 Stars</option>
                <option [value]="3">‚≠ê‚≠ê‚≠ê 3 Stars</option>
                <option [value]="4">‚≠ê‚≠ê‚≠ê‚≠ê 4 Stars</option>
                <option [value]="5">‚≠ê‚≠ê‚≠ê‚≠ê‚≠ê 5 Stars</option>
              </select>
            </div>
            <button 
              class="btn btn-success w-100"
              (click)="submitComment()"
              [disabled]="!newUsername.trim() || !newComment.trim()"
            >
              <i class="bi bi-send"></i> Submit Comment
            </button>
          </div>
        </div>
      </div>
    </div>
  </div>
</div>





